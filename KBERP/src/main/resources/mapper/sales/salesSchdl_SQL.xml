<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="salesSchdl">
	<insert id="salesSchdlAdd" parameterType="hashmap">
		INSERT INTO  SALES_SCHDL(SCHDL_NUM, EMP_NUM, SALES_NUM, LEAD_NUM, ACTVTY_CLSFY_NUM, START_DATE_HR, END_DATE_HR, ACTVTY_CONT)
		VALUES (SALES_SCHDL_SEQ.NEXTVAL, #{sEmpNum}, #{sNum}, #{lNum}, #{ssactvtyclsfy}, #{sdt}, #{edt}, #{ssactvtycont})
	</insert>
	<select id="getSalesSchdlList" parameterType="hashmap" resultType="hashmap">
		SELECT A.START_DATE_HR, A.END_DATE_HR, A.ACTVTY_CLSFY_NUM, A.CLNT_CMPNY_NAME
		FROM ( SELECT SS.START_DATE_HR , SS.END_DATE_HR, SS.ACTVTY_CLSFY_NUM, CC.CLNT_CMPNY_NAME,
					  ROW_NUMBER() OVER(ORDER BY SS.START_DATE_HR DESC) AS RNUM
			   FROM SALES_SCHDL SS LEFT JOIN LEAD L
										  ON SS.LEAD_NUM = L.LEAD_NUM
								   LEFT JOIN SALES S
										  ON SS.SALES_NUM = S.SALES_NUM
								   LEFT JOIN ENTRPRS_CLNT CL
										  ON L.CLNT_NUM = CL.CLNT_NUM
								   LEFT JOIN CLNT_CMPNY CC
										  ON CL.CLNT_CMPNY_NUM = CC.CLNT_CMPNY_NUM
			  WHERE SUBSTR(SS.START_DATE_HR, 1, 10) = #{tday}) A
	    ORDER BY A.RNUM DESC
	</select>
</mapper>