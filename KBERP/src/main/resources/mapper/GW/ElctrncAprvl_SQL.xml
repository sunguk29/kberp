<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="elctrncAprvl">
	<select id="getAprvlTmpltBox" resultType="hashmap" parameterType="hashmap">
		SELECT E.TMPLT_NUM, E.TMPLT_DVSN_NUM, E.TMPLT_NAME, E.TMPLT_CONT, D.TMPLT_DVSN_NAME, E.DEL_CHECK, ROW_NUMBER()OVER(ORDER BY TMPLT_NUM ASC) AS RNUM
		FROM(SELECT TMPLT_NUM, TMPLT_DVSN_NUM, TMPLT_NAME, TMPLT_CONT, DEL_CHECK,ROW_NUMBER()OVER(ORDER BY TMPLT_NUM ASC) AS RNUM
		FROM DRAFT_TMPLT) E INNER JOIN DRAFT_TMPLT_DVSN D
		ON E.TMPLT_DVSN_NUM = D.TMPLT_DVSN_NUM
	</select>

	<select id="draftTmpltBoxWrite" parameterType="hashmap">
	
	</select>

<select id = "aprvlSeq" resultType="String">
	SELECT APRVL_SEQ.NEXTVAL
	FROM DUAL
</select>

<insert id = "aprvlLineAdd" parameterType="hashmap">
	INSERT INTO APRVL (APRVL_NUM, EMP_NUM, TITLE, CONT, DRAFT_DATE)
	VALUES(#{al}, #{empNum}, #{title}, #{cont}, TO_CHAR(SYSDATE, 'YYYY-MM-DD'))
</insert>

<select id = "aprvlRfrncSeq" resultType="String"> 
	SELECT APRVL_RFRNC_SEQ.NEXTVAL
	FROM DUAL
</select>

<select id = "addListChat" parameterType = "hashmap" resultType="hashmap">
SELECT *
FROM (SELECT E.EMP_NUM, E.EMP_NAME, D.DEPT_NAME, R.RANK_NAME, AL.APRVL_STS
FROM  EMP E INNER JOIN APNTM A
                        ON E.EMP_NUM = A.EMP_NUM
            INNER JOIN DEPT D
                        ON A.DEPT_NUM = D.DEPT_NUM
            INNER JOIN RANK R
                        ON A.RANK_NUM = R.RANK_NUM 
            INNER JOIN APRVL_LINE AL
                        ON A.EMP_NUM = AL.EMP_NUM
     )
WHERE 1 = 1
</select>

<select id="tmpltCont" parameterType="hashmap" resultType="hashmap">
SELECT *
FROM DRAFT_TMPLT
WHERE TMPLT_NUM = #{no}
</select>

</mapper>
